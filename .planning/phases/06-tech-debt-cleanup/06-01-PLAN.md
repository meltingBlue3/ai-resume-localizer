---
phase: 06-tech-debt-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/components/upload/PhotoDropzone.tsx
  - frontend/src/stores/useResumeStore.ts
  - frontend/src/i18n/locales/zh/wizard.json
  - frontend/src/i18n/locales/ja/wizard.json
  - frontend/src/components/wizard/StepNavigation.tsx
autonomous: true
requirements:
  - TECH-01
  - TECH-02

must_haves:
  truths:
    - "PhotoDropzone.tsx does not exist in the codebase"
    - "photoFile and setPhotoFile are absent from the Zustand resume store"
    - "The preview step (last wizard step) does not render a non-functional finish button"
    - "The application builds without errors after cleanup"
    - "All existing wizard flows (upload, review extraction, review translation, preview/download) work unchanged"
  artifacts:
    - path: "frontend/src/stores/useResumeStore.ts"
      provides: "Resume store without photoFile dead code"
      contains: "resumeFile"
    - path: "frontend/src/components/wizard/StepNavigation.tsx"
      provides: "Step navigation that hides finish button on last step"
  key_links:
    - from: "frontend/src/steps/UploadStep.tsx"
      to: "frontend/src/stores/useResumeStore.ts"
      via: "setResumeFile (not setPhotoFile)"
      pattern: "setResumeFile"
    - from: "frontend/src/components/wizard/StepNavigation.tsx"
      to: "frontend/src/stores/useWizardStore.ts"
      via: "currentStep/totalSteps for last-step detection"
      pattern: "isLast"
---

<objective>
Remove dead PhotoDropzone code and fix the non-functional finish button on the preview step.

Purpose: Eliminate tech debt from v1.0 — dead code that was superseded by the PhotoCropper in PreviewStep, and a UI element (完了 button) that renders on the last wizard step but does nothing when clicked.

Output: Clean codebase with no dead photo upload code and correct last-step navigation behavior.
</objective>

<execution_context>
@C:/Users/zhang/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/zhang/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@frontend/src/components/upload/PhotoDropzone.tsx
@frontend/src/stores/useResumeStore.ts
@frontend/src/components/wizard/StepNavigation.tsx
@frontend/src/stores/useWizardStore.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove dead PhotoDropzone code and photoFile store field</name>
  <files>
    frontend/src/components/upload/PhotoDropzone.tsx
    frontend/src/stores/useResumeStore.ts
    frontend/src/i18n/locales/zh/wizard.json
    frontend/src/i18n/locales/ja/wizard.json
  </files>
  <action>
1. Delete the file `frontend/src/components/upload/PhotoDropzone.tsx` entirely. It is not imported anywhere — UploadStep uses FileDropzone, and photo upload in PreviewStep uses a native file input + PhotoCropper.

2. In `frontend/src/stores/useResumeStore.ts`:
   - Remove `photoFile: File | null;` from the `ResumeState` interface (line 6)
   - Remove `setPhotoFile: (file: File | null) => void;` from the interface (line 25)
   - Remove `photoFile: null,` from `initialState` (line 43)
   - Remove `setPhotoFile: (file) => set({ photoFile: file }),` from the store creator (line 62)

3. In `frontend/src/i18n/locales/zh/wizard.json`:
   - Remove the three i18n keys under `steps.upload` that are only used by PhotoDropzone: `photoLabel`, `photoDropzone`, `photoFormats` (lines 11-13)

4. In `frontend/src/i18n/locales/ja/wizard.json`:
   - Remove the same three i18n keys: `photoLabel`, `photoDropzone`, `photoFormats` (lines 11-13)

These keys are NOT used by any other component — confirmed via grep.
  </action>
  <verify>
- Run `npx tsc --noEmit` in frontend/ — no type errors
- Confirm PhotoDropzone.tsx no longer exists: `ls frontend/src/components/upload/PhotoDropzone.tsx` should fail
- Grep for `photoFile` in frontend/src/ — zero matches
- Grep for `PhotoDropzone` in frontend/src/ — zero matches
  </verify>
  <done>PhotoDropzone.tsx deleted, photoFile/setPhotoFile removed from store, orphaned i18n keys removed. TypeScript compiles cleanly.</done>
</task>

<task type="auto">
  <name>Task 2: Fix non-functional finish button on preview step</name>
  <files>frontend/src/components/wizard/StepNavigation.tsx</files>
  <action>
In `frontend/src/components/wizard/StepNavigation.tsx`, the next/finish button always renders. On the last step (PreviewStep, index 3), it shows "完了" but `nextStep()` is a no-op because `currentStep < totalSteps - 1` is false.

Fix: Do not render the forward button when `isLast` is true. The user's workflow on PreviewStep is to download PDFs via the PreviewToolbar buttons — there is no meaningful "next" destination.

Specifically, wrap the forward button in a condition: `{!isLast && (<button ...>{t('next')}</button>)}`. Since the button only shows on non-last steps, the text is always 'next' (never 'finish'), so remove the ternary `isLast ? t('finish') : t('next')` and just use `t('next')`.

The back button remains visible on non-first steps (unchanged).
  </action>
  <verify>
- Run `npx tsc --noEmit` in frontend/ — no type errors
- Run `npm run build` in frontend/ — builds successfully
- Manual check: on step 0 (Upload), only "Next" button visible (no back). On steps 1-2, both "Previous" and "Next" visible. On step 3 (Preview), only "Previous" visible — no finish/next button.
  </verify>
  <done>The preview step no longer shows a non-functional 完了 button. Navigation buttons are: step 0 = next only, steps 1-2 = previous + next, step 3 = previous only.</done>
</task>

</tasks>

<verification>
1. `cd frontend && npx tsc --noEmit` — zero type errors
2. `cd frontend && npm run build` — builds successfully with no warnings related to removed code
3. `grep -r "PhotoDropzone" frontend/src/` — zero matches
4. `grep -r "photoFile" frontend/src/` — zero matches
5. `grep -r "photoLabel\|photoDropzone\|photoFormats" frontend/src/` — zero matches (only in i18n JSON files which were cleaned)
6. Start dev server, walk through all 4 wizard steps — upload works, extraction review works, translation review works, preview renders with download buttons, no broken UI elements
</verification>

<success_criteria>
- PhotoDropzone.tsx is deleted from the codebase
- photoFile and setPhotoFile are absent from useResumeStore
- Orphaned i18n keys (photoLabel, photoDropzone, photoFormats) removed from both zh and ja locales
- StepNavigation does not render a forward button on the last step
- `npm run build` succeeds in frontend/
- All existing wizard flows function correctly
</success_criteria>

<output>
After completion, create `.planning/phases/06-tech-debt-cleanup/06-01-SUMMARY.md`
</output>
