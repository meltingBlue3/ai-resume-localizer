app:
  description: å°†ä¸­æ–‡ç®€å†çº¯æ–‡æœ¬è§£æä¸ºç¬¦åˆæ—¥æœ¬ç®€å†æ ‡å‡†çš„ç»“æ„åŒ–JSONæ•°æ®ï¼Œä¾›åç«¯ /api/upload-and-extract æ¥å£æ¶ˆè´¹
  icon: ğŸ¤–
  icon_background: '#E8F4FD'
  mode: workflow
  name: ä¸­æ–‡ç®€å†ç»“æ„åŒ–æå–v1.2
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/openrouter:0.0.35@89dd7d9ef460b2b687728168080132806c5e31ce7cf3c2f70c9e4a10a5750190
    version: null
kind: app
version: 0.5.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions: []
      allowed_file_types: []
      allowed_file_upload_methods: []
      enabled: false
      fileUploadConfig:
        attachment_image_file_size_limit: 2
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        file_upload_limit: 50
        image_file_batch_limit: 10
        image_file_size_limit: 10
        single_chunk_attachment_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInIteration: false
        sourceType: start
        targetType: llm
      id: 1740000000001-source-1740000000002-target
      selected: false
      source: '1740000000001'
      sourceHandle: source
      target: '1740000000002'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: code
      id: 1740000000002-source-1740000000005-target
      selected: false
      source: '1740000000002'
      sourceHandle: source
      target: '1740000000005'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: code
      id: 1740000000005-source-1740000000003-target
      selected: false
      source: '1740000000005'
      sourceHandle: source
      target: '1740000000003'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: code
      id: 1740000000003-source-1740000000006-target
      selected: false
      source: '1740000000003'
      sourceHandle: source
      target: '1740000000006'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: end
      id: 1740000000006-source-1740000000004-target
      selected: false
      source: '1740000000006'
      sourceHandle: source
      target: '1740000000004'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: æ¥æ”¶ç”±åç«¯ text_extractor æå–çš„ä¸­æ–‡ç®€å†çº¯æ–‡æœ¬
        selected: false
        title: å¼€å§‹
        type: start
        variables:
        - label: ç®€å†æ–‡æœ¬
          max_length: 15000
          options: []
          required: true
          type: paragraph
          variable: resume_text
      height: 153
      id: '1740000000001'
      position:
        x: 80
        y: 282
      positionAbsolute:
        x: 80
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ä»ç®€å†æ–‡æœ¬ä¸­æå–æ˜ç¡®è®°è½½çš„ä¿¡æ¯ï¼Œè¾“å‡ºçº¯ JSON
        model:
          completion_params:
            temperature: 0.1
            top_p: 1
          mode: chat
          name: google/gemini-3-flash-preview
          provider: langgenius/openrouter/openrouter
        prompt_template:
        - id: a1b2c3d4-0001-0001-0001-000000000001
          role: system
          text: "<system_role>\nä½ æ˜¯ä¸€ä¸ªé«˜ç²¾åº¦çš„ç®€å†æ•°æ®ç»“æ„åŒ–æŠ½å–å¼•æ“ã€‚ä½ çš„ä»»åŠ¡æ˜¯å°†å¸¦æœ‰ OCR å™ªéŸ³çš„ä¸­æ–‡ç®€å†æ–‡æœ¬ï¼Œæå–ã€é‡ç»„å¹¶ä¼˜åŒ–ä¸ºé«˜è´¨é‡çš„\
            \ JSON æ ¼å¼æ•°æ®ã€‚\n</system_role>\n\n<core_rules>\n  <rule_1_noise_reduction>\n\
            \    è¾“å…¥æ–‡æœ¬å¯èƒ½æ¥è‡ª OCR æˆ– PDF è§£æï¼Œå­˜åœ¨æ¢è¡Œé”™ä¹±ã€é¡µçœ‰æ··å…¥ã€ä¿¡æ¯ä¹±åºç­‰ç‰©ç†å™ªéŸ³ã€‚è¯·ä½ åŸºäºè¯­ä¹‰é€»è¾‘ï¼Œè‡ªåŠ¨æ‹¼æ¥æ–­å¼€çš„å¥å­ï¼Œå¿½ç•¥é¡µç å’Œæ— æ„ä¹‰çš„ä¹±ç å­—ç¬¦ã€‚\n\
            \  </rule_1_noise_reduction>\n  \n  <rule_2_expression_optimization>\n\
            \    åœ¨æå–å·¥ä½œç»éªŒå’Œé¡¹ç›®ç»éªŒæ—¶ï¼Œè¯·å¯¹å€™é€‰äººçš„åŸå§‹è¡¨è¿°è¿›è¡Œä¸“ä¸šåŒ–æ¶¦è‰²ï¼š\n    - å°†å£è¯­åŒ–ã€æµæ°´è´¦å¼çš„æè¿°ï¼Œæç‚¼ä¸ºä¸“ä¸šçš„ã€ç»“æ„åŒ–çš„è¦ç‚¹ï¼ˆæ¨èä½¿ç”¨â€œæ ¸å¿ƒèŒè´£â€ä¸â€œå–å¾—æˆæœâ€çš„ç»´åº¦ï¼‰ã€‚\n\
            \    - çº æ­£æ˜æ˜¾çš„è¯­ç—…å’Œé”™åˆ«å­—ã€‚\n    - **çº¢çº¿è­¦å‘Š**ï¼šç»å¯¹ç¦æ­¢æé€ åŸæ–‡ä¸­ä¸å­˜åœ¨çš„æŠ€æœ¯æ ˆã€è™šæ„æ•°æ®æŒ‡æ ‡æˆ–æé€ å·¥ä½œç»å†ã€‚åªèƒ½â€œæç‚¼å’Œæ¶¦è‰²â€ï¼Œä¸èƒ½â€œæ— ä¸­ç”Ÿæœ‰â€ï¼Œä¸èƒ½â€œå¤¸å¤§â€ã€‚\n\
            \  </rule_2_expression_optimization>\n\n  <rule_3_strict_json>\n    ä¸è¦è¾“å‡ºä»»ä½•\
            \ markdown æ ‡è®°ï¼ˆå¦‚ ```jsonï¼‰ã€ä¸è¦è¾“å‡º <think> ç­‰æ€è€ƒè¿‡ç¨‹ï¼Œä¸è¦åŒ…å«ä»»ä½•è§£é‡Šæ€§æ–‡å­—ã€‚å¿…é¡»ä¸¥æ ¼æŒ‰ç…§ä¸‹é¢çš„ JSON\
            \ ç»“æ„è¾“å‡ºã€‚\n  </rule_3_strict_json>\n</core_rules>\n\n<extraction_guidelines>\n\
            \  - ç©ºå€¼ï¼šæœªæåŠçš„å­—æ®µå¡« nullï¼Œç©ºåˆ—è¡¨å¡« []ã€‚\n  - æ—¥æœŸï¼šå°è¯•æ ¼å¼åŒ–ä¸º YYYY-MMï¼Œå¦‚åªæœ‰å¹´ä»½åˆ™å¡« YYYYã€‚åœ¨èŒ/è‡³ä»Šå¡«\
            \ nullã€‚\n  - è¾¹ç•Œï¼šå•†ä¸šå…¬å¸çš„å±¥å†æ”¾å…¥ work_experienceï¼›å…·ä½“çš„å¼€å‘ç³»ç»Ÿã€åˆ†ææ¨¡å‹ã€ç‹¬ç«‹è¯¾é¢˜ç­‰æ”¾å…¥ project_experienceã€‚è‹¥å·¥ä½œå†…åµŒå¥—äº†é¡¹ç›®ï¼Œéœ€æ‹†åˆ†ã€‚\n\
            \  - è¯ä¹¦ä¸æŠ€èƒ½ï¼šå°†æåŠçš„æ‰€æœ‰èµ„æ ¼è®¤è¯ï¼ˆè¯­è¨€ã€ITã€èŒä¸šè®¤è¯ï¼‰å¼ºåˆ¶æå–åˆ° certifications ä¸­ã€‚æ‰€æœ‰å·¥å…·ã€è¯­è¨€ã€ä¸“ä¸šæ–¹æ³•è®ºæå–åˆ°\
            \ skills ä¸­ã€‚\n</extraction_guidelines>\n\n<output_schema>\n{\n  \"name\"\
            : \"å§“å\",\n  \"phone\": \"ç”µè¯å·ç \",\n  \"email\": \"é‚®ç®±åœ°å€\",\n  \"date_of_birth\"\
            : \"YYYY-MM-DD æˆ– YYYY-MM\",\n  \"age\": \"å¹´é¾„\"\n  \"address\": \"å±…ä½åœ°å€\"\
            ,\n  \"nationality\": \"å›½ç±\",\n  \"gender\": \"æ€§åˆ«\",\n  \"emergency_contact_address\"\
            : \"ç´§æ€¥è”ç³»åœ°å€ï¼ˆæ—¥æœ¬ç®€å†ä¸­çš„é€£çµ¡å…ˆï¼‰\",\n  \"commute_time\": \"é€šå‹¤æ—¶é—´\",\n  \"marital_status\"\
            : \"å©šå§»çŠ¶å†µï¼ˆå·²å©š/æœªå©šï¼‰\",\n  \"dependents_count\": \"æ‰¶å…»äººæ•°ï¼ˆé™¤é…å¶å¤–çš„å®¶å±äººæ•°ï¼‰\",\n  \"\
            expected_salary\": \"æœŸæœ›è–ªèµ„\",\n  \"education\": [\n    {\n      \"school\"\
            : \"å­¦æ ¡åç§°\",\n      \"major\": \"ä¸“ä¸š\",\n      \"degree\": \"å­¦å†/å­¦ä½\",\n\
            \      \"start_date\": \"YYYY-MM\",\n      \"end_date\": \"YYYY-MM\"\n\
            \    }\n  ],\n  \"work_experience\": [\n    {\n      \"company\": \"å…¬å¸æˆ–ç»„ç»‡åç§°\"\
            ,\n      \"position\": \"èŒä½åç§°\",\n      \"department\": \"éƒ¨é—¨\",\n    \
            \  \"start_date\": \"YYYY-MM\",\n      \"end_date\": \"YYYY-MM\",\n  \
            \    \"description\": \"ç»ä¸“ä¸šæ¶¦è‰²åçš„å·¥ä½œèŒè´£ä¸ä¸šç»©æè¿°\"\n    }\n  ],\n  \"project_experience\"\
            : [\n    {\n      \"project_name\": \"é¡¹ç›®åç§°\",\n      \"associated_company\"\
            : \"æ‰€å±å…¬å¸/ç»„ç»‡ï¼ˆæ— æ³•æ¨æ–­å¡« nullï¼‰\",\n      \"role\": \"æ‹…ä»»è§’è‰²\",\n      \"start_date\"\
            : \"YYYY-MM\",\n      \"end_date\": \"YYYY-MM\",\n      \"description\"\
            : \"ç»ä¸“ä¸šæ¶¦è‰²åçš„é¡¹ç›®èƒŒæ™¯ã€ä½¿ç”¨çš„æŠ€æœ¯/å·¥å…·åŠæœ€ç»ˆæˆæœ\"\n    }\n  ],\n  \"skills\": [\n    {\n\
            \      \"name\": \"æŠ€èƒ½åç§°\",\n      \"level\": \"æŒæ¡ç¨‹åº¦ï¼ˆåŸæ–‡æ— åˆ™å¡« nullï¼‰\"\n  \
            \  }\n  ],\n  \"certifications\": [\n    {\n      \"name\": \"è¯ä¹¦åç§°\",\n\
            \      \"date\": \"è·å¾—æ—¥æœŸï¼ˆå°½å¯èƒ½æå–ï¼‰\"\n    }\n  ],\n  \"languages\": [\"è¯­è¨€åç§°åŠèƒ½åŠ›æè¿°\"\
            ],\n  \"self_introduction\": \"ç»æ¶¦è‰²åçš„è‡ªæˆ‘è¯„ä»·ï¼Œå»é™¤å‡å¤§ç©ºçš„åºŸè¯\",\n  \"portfolio_links\"\
            : [\"ä¸ªäººä¸»é¡µã€ä½œå“é›†ã€GitHubç­‰é“¾æ¥\"],\n  \"other\": \"å…¶ä»–è¡¥å……ä¿¡æ¯ï¼ˆçº¯ä¸­æ–‡ï¼‰\"\n}\n</output_schema>"
        - id: a1b2c3d4-0001-0001-0001-000000000002
          role: user
          text: '<input_resume_text>

            {{#1740000000001.resume_text#}}

            </input_resume_text>'
        selected: false
        title: LLM æå–ç®€å†ä¿¡æ¯
        type: llm
        variables: []
        vision:
          enabled: false
      height: 132
      id: '1740000000002'
      position:
        x: 368
        y: 303
      positionAbsolute:
        x: 368
        y: 303
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "import re\n\ndef main(llm_text: str) -> dict:\n    # Strip <think>...</think>\
          \ blocks (including multiline)\n    text = re.sub(r'<think>[\\s\\S]*?</think>',\
          \ '', llm_text, flags=re.DOTALL)\n    return {\"result\": text.strip()}\n"
        code_language: python3
        desc: LLM å‡ºåŠ›ã‹ã‚‰ <think> ã‚¿ã‚°ã‚’é™¤å»
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: CoT ã‚¹ãƒˆãƒªãƒƒãƒ—
        type: code
        variables:
        - value_selector:
          - '1740000000002'
          - text
          variable: llm_text
      height: 80
      id: '1740000000005'
      position:
        x: 655
        y: 303
      positionAbsolute:
        x: 655
        y: 303
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "import json\nimport re\n\ndef main(llm_text: str) -> dict:\n    text\
          \ = llm_text.strip()\n\n    # 1ï¸âƒ£ å»æ‰ markdown ä»£ç å—ï¼ˆå¦‚æœå­˜åœ¨ï¼‰\n    text = re.sub(r'^```(?:json)?\\\
          s*\\n?', '', text)\n    text = re.sub(r'\\n?```\\s*$', '', text)\n    text\
          \ = text.strip()\n\n    # 2ï¸âƒ£ æ‰¾åˆ°ç¬¬ä¸€ä¸ª '{'\n    start = text.find('{')\n  \
          \  if start == -1:\n        raise ValueError(\"No JSON object found in LLM\
          \ output\")\n\n    text = text[start:]\n\n    # 3ï¸âƒ£ ä½¿ç”¨ JSONDecoder è§£æé¦–ä¸ªåˆæ³•\
          \ JSON\n    decoder = json.JSONDecoder()\n\n    try:\n        parsed, _\
          \ = decoder.raw_decode(text)\n    except json.JSONDecodeError as e:\n  \
          \      raise ValueError(\n            f\"LLM returned invalid JSON: {e}\\\
          n\"\n            f\"Content preview: {text[:500]}\"\n        )\n\n    return\
          \ {\"result\": json.dumps(parsed, ensure_ascii=False)}\n"
        code_language: python3
        desc: æ¸…æ´— LLM è¾“å‡ºï¼Œå»é™¤ markdown ä»£ç å—æ ‡è®°ï¼Œå¹¶éªŒè¯ JSON åˆæ³•æ€§
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: æ¸…æ´— JSON è¾“å‡º
        type: code
        variables:
        - value_selector:
          - '1740000000005'
          - result
          variable: llm_text
      height: 96
      id: '1740000000003'
      position:
        x: 942
        y: 303
      positionAbsolute:
        x: 942
        y: 303
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "import json\n\ndef main(json_str: str) -> dict:\n    data = json.loads(json_str)\n\
          \n    def sort_key(entry):\n        \"\"\"Sort by start_date descending.\
          \ Entries without dates go last.\"\"\"\n        sd = entry.get(\"start_date\"\
          ) or \"\"\n        return sd\n\n    for field in (\"work_experience\", \"\
          education\", \"project_experience\"):\n        items = data.get(field)\n\
          \        if isinstance(items, list) and len(items) > 1:\n            data[field]\
          \ = sorted(items, key=sort_key, reverse=True)\n\n    return {\"result\"\
          : json.dumps(data, ensure_ascii=False)}\n"
        code_language: python3
        desc: æŒ‰ start_date é™åºæ’åˆ—å·¥ä½œç»éªŒã€æ•™è‚²å’Œé¡¹ç›®ç»éªŒ
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: æ—¥ä»˜ã‚½ãƒ¼ãƒˆ
        type: code
        variables:
        - value_selector:
          - '1740000000003'
          - result
          variable: json_str
      height: 96
      id: '1740000000006'
      position:
        x: 1229
        y: 303
      positionAbsolute:
        x: 1229
        y: 303
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: è¾“å‡ºç»“æ„åŒ–ç®€å† JSONï¼Œå˜é‡å structured_resume ä¾›åç«¯ DifyClient è¯»å–
        outputs:
        - value_selector:
          - '1740000000006'
          - result
          variable: structured_resume
        selected: false
        title: ç»“æŸ
        type: end
      height: 149
      id: '1740000000004'
      position:
        x: 1516
        y: 303
      positionAbsolute:
        x: 1516
        y: 303
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    viewport:
      x: -267.7201008123827
      y: 229.1983273936014
      zoom: 0.9253024439904598
  rag_pipeline_variables: []
