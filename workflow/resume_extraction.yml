app:
  description: å°†ä¸­æ–‡ç®€å†çº¯æ–‡æœ¬è§£æä¸ºç¬¦åˆæ—¥æœ¬ç®€å†æ ‡å‡†çš„ç»“æ„åŒ–JSONæ•°æ®ï¼Œä¾›åç«¯ /api/upload-and-extract æ¥å£æ¶ˆè´¹
  icon: ğŸ“„
  icon_background: '#E8F4FD'
  mode: workflow
  name: ä¸­æ–‡ç®€å†ç»“æ„åŒ–æå–
  use_icon_as_answer_icon: false
kind: app
version: 0.1.3
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions: []
      allowed_file_types: []
      allowed_file_upload_methods: []
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
          - local_file
          - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
      - data:
          isInIteration: false
          sourceType: start
          targetType: llm
        id: 1740000000001-source-1740000000002-target
        selected: false
        source: '1740000000001'
        sourceHandle: source
        target: '1740000000002'
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          sourceType: llm
          targetType: code
        id: 1740000000002-source-1740000000003-target
        selected: false
        source: '1740000000002'
        sourceHandle: source
        target: '1740000000003'
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          sourceType: code
          targetType: end
        id: 1740000000003-source-1740000000004-target
        selected: false
        source: '1740000000003'
        sourceHandle: source
        target: '1740000000004'
        targetHandle: target
        type: custom
        zIndex: 0
    nodes:
      # â”€â”€ Node 1: Start â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - data:
          desc: æ¥æ”¶ç”±åç«¯ text_extractor æå–çš„ä¸­æ–‡ç®€å†çº¯æ–‡æœ¬
          selected: false
          title: å¼€å§‹
          type: start
          variables:
            - label: ç®€å†æ–‡æœ¬
              max_length: 15000
              options: []
              required: true
              type: paragraph
              variable: resume_text
        height: 90
        id: '1740000000001'
        position:
          x: 80
          y: 282
        positionAbsolute:
          x: 80
          y: 282
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244

      # â”€â”€ Node 2: LLM â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - data:
          context:
            enabled: false
            variable_selector: []
          desc: ä½¿ç”¨å¤§æ¨¡å‹ä»ç®€å†æ–‡æœ¬ä¸­æå–æ‰€æœ‰å…³é”®å­—æ®µï¼Œè¾“å‡ºçº¯JSON
          model:
            completion_params:
              frequency_penalty: 0
              max_tokens: 4096
              presence_penalty: 0
              temperature: 0.1
              top_p: 1
            mode: chat
            # å¯¼å…¥åè¯·åœ¨ Dify UI ä¸­åˆ‡æ¢ä¸ºå·²é…ç½®çš„æ¨¡å‹ï¼ˆå¦‚ gpt-4o / claude-3-5-sonnetï¼‰
            name: gpt-4o
            provider: openai
          prompt_template:
            - id: a1b2c3d4-0001-0001-0001-000000000001
              role: system
              text: |
                ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„ä¸­æ–‡ç®€å†è§£æä¸“å®¶ã€‚ä½ çš„ä»»åŠ¡æ˜¯ä»ç”¨æˆ·æä¾›çš„ä¸­æ–‡ç®€å†æ–‡æœ¬ä¸­ï¼Œå‡†ç¡®æå–æ‰€æœ‰å…³é”®ä¿¡æ¯ï¼Œå¹¶ä»¥ä¸¥æ ¼åˆæ³•çš„ JSON æ ¼å¼è¾“å‡ºï¼Œä¸å¾—æ·»åŠ ä»»ä½•è§£é‡Šæ–‡å­—æˆ– markdown ä»£ç å—æ ‡è®°ã€‚

                ## è¾“å‡º JSON ç»“æ„

                è¾“å‡ºå¿…é¡»æ˜¯ä»¥ä¸‹ç»“æ„çš„ JSON å¯¹è±¡ï¼Œæ‰€æœ‰å­—æ®µå‡å¯ä¸º nullï¼š

                {
                  "name": "å§“å",
                  "phone": "ç”µè¯å·ç ",
                  "email": "é‚®ç®±åœ°å€",
                  "date_of_birth": "å‡ºç”Ÿæ—¥æœŸï¼Œæ ¼å¼ YYYY-MM-DD æˆ– YYYY-MM",
                  "address": "å±…ä½åœ°å€",
                  "nationality": "å›½ç±",
                  "gender": "æ€§åˆ«",
                  "education": [
                    {
                      "school": "å­¦æ ¡åç§°",
                      "major": "ä¸“ä¸š",
                      "degree": "å­¦å†/å­¦ä½ï¼Œå¦‚æœ¬ç§‘/ç¡•å£«/åšå£«",
                      "start_date": "å¼€å§‹æ—¶é—´ï¼Œæ ¼å¼ YYYY-MM",
                      "end_date": "ç»“æŸæ—¶é—´ï¼Œæ ¼å¼ YYYY-MM"
                    }
                  ],
                  "work_experience": [
                    {
                      "company": "å…¬å¸åç§°",
                      "position": "èŒä½åç§°",
                      "department": "éƒ¨é—¨",
                      "start_date": "å¼€å§‹æ—¶é—´ï¼Œæ ¼å¼ YYYY-MM",
                      "end_date": "ç»“æŸæ—¶é—´ï¼Œæ ¼å¼ YYYY-MMï¼Œåœ¨èŒåˆ™å¡« null",
                      "description": "å·¥ä½œå†…å®¹æè¿°"
                    }
                  ],
                  "skills": [
                    {
                      "name": "æŠ€èƒ½åç§°",
                      "level": "æŒæ¡ç¨‹åº¦ï¼Œå¦‚ç²¾é€š/ç†Ÿç»ƒ/äº†è§£"
                    }
                  ],
                  "certifications": [
                    {
                      "name": "è¯ä¹¦åç§°",
                      "date": "è·å¾—æ—¥æœŸï¼Œæ ¼å¼ YYYY-MM"
                    }
                  ],
                  "languages": ["è¯­è¨€èƒ½åŠ›ï¼Œå¦‚æ™®é€šè¯ã€è‹±è¯­ CET-6"],
                  "self_introduction": "è‡ªæˆ‘ä»‹ç»æ®µè½",
                  "career_objective": "æ±‚èŒæ„å‘",
                  "project_experience": [
                    {
                      "company": null,
                      "position": "é¡¹ç›®ä¸­æ‹…ä»»çš„è§’è‰²",
                      "department": null,
                      "start_date": "å¼€å§‹æ—¶é—´ï¼Œæ ¼å¼ YYYY-MM",
                      "end_date": "ç»“æŸæ—¶é—´ï¼Œæ ¼å¼ YYYY-MM",
                      "description": "é¡¹ç›®æè¿°"
                    }
                  ],
                  "awards": ["è·å¥–è®°å½•ï¼Œæ¯æ¡ä¸ºå­—ç¬¦ä¸²"],
                  "hobbies": "å…´è¶£çˆ±å¥½"
                }

                ## æå–è§„åˆ™

                1. ç®€å†ä¸­æœªæ˜ç¡®æåŠçš„å­—æ®µå¿…é¡»å¡« nullï¼Œä¸å¯å¡«ç©ºå­—ç¬¦ä¸² ""
                2. åˆ—è¡¨å­—æ®µè‹¥æ— å†…å®¹ï¼Œå¡« [] æˆ– null
                3. æ—¥æœŸç»Ÿä¸€è½¬æ¢ä¸º YYYY-MM æ ¼å¼ï¼ˆå¦‚"2020å¹´3æœˆ"â†’"2020-03"ï¼‰
                4. å·¥ä½œç»å†å’Œæ•™è‚²ç»å†æŒ‰æ—¶é—´å€’åºæ’åˆ—ï¼ˆæœ€è¿‘çš„åœ¨å‰ï¼‰
                5. æŠ€èƒ½æå–æ—¶ä¿ç•™åŸå§‹çš„æŒæ¡ç¨‹åº¦æè¿°
                6. åªè¾“å‡º JSON å¯¹è±¡æœ¬èº«ï¼Œç¦æ­¢æ·»åŠ ä»»ä½•è§£é‡Šã€å‰ç¼€æˆ– markdown æ ‡è®°
            - id: a1b2c3d4-0001-0001-0001-000000000002
              role: user
              text: "è¯·è§£æä»¥ä¸‹ä¸­æ–‡ç®€å†æ–‡æœ¬ï¼š\n\n{{#1740000000001.resume_text#}}"
          selected: false
          title: LLM æå–ç®€å†ä¿¡æ¯
          type: llm
          variables: []
          vision:
            enabled: false
        height: 98
        id: '1740000000002'
        position:
          x: 420
          y: 282
        positionAbsolute:
          x: 420
          y: 282
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244

      # â”€â”€ Node 3: Code â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - data:
          code: |
            import re
            import json

            def main(llm_text: str) -> dict:
                text = llm_text.strip()

                # Strip markdown code block wrappers that some models add
                text = re.sub(r'^```(?:json)?\s*\n?', '', text)
                text = re.sub(r'\n?```\s*$', '', text)
                text = text.strip()

                # Validate the output is parseable JSON before passing downstream
                try:
                    json.loads(text)
                except json.JSONDecodeError as e:
                    raise ValueError(
                        f"LLM returned invalid JSON: {e}\n"
                        f"Content preview: {text[:300]}"
                    )

                return {"result": text}
          code_language: python3
          desc: æ¸…æ´— LLM è¾“å‡ºï¼Œå»é™¤ markdown ä»£ç å—æ ‡è®°ï¼Œå¹¶éªŒè¯ JSON åˆæ³•æ€§
          outputs:
            result:
              children: null
              type: string
          selected: false
          title: æ¸…æ´— JSON è¾“å‡º
          type: code
          variables:
            - value_selector:
                - '1740000000002'
                - text
              variable: llm_text
        height: 54
        id: '1740000000003'
        position:
          x: 760
          y: 282
        positionAbsolute:
          x: 760
          y: 282
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244

      # â”€â”€ Node 4: End â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - data:
          desc: è¾“å‡ºç»“æ„åŒ–ç®€å† JSONï¼Œå˜é‡å structured_resume ä¾›åç«¯ DifyClient è¯»å–
          outputs:
            - value_selector:
                - '1740000000003'
                - result
              variable: structured_resume
          selected: false
          title: ç»“æŸ
          type: end
        height: 90
        id: '1740000000004'
        position:
          x: 1100
          y: 282
        positionAbsolute:
          x: 1100
          y: 282
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 244

    viewport:
      x: 0
      y: 0
      zoom: 0.9
